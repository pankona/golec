# 2017/09/05 のメモ

## メニュー

### git/github の使い方に関してのおさらい

既にいっぱい使っていると思いますが、TIPS 的なものを記載していきます。

* シチュエーション別 git の使い方
  * 細かいコミットがいっぱいなので、いくつかくっつけて一個にしたい
  * コミットログを間違えたので修正したい
  * 直前のコミットに入れ忘れた変更があった…
  * 2個以上前のコミットに入れ忘れた変更があった…
  * 俺のブランチより master が先に進んでしまってマージできない
  * プルリクがマージされるまで作業が進められない気がする
  * コミットログは適当でいい？

* github の使い方
  * 慣れてきたらフォークして開発するのがオススメ
  * レビュアーのアサイン
  * マージされたらブランチは消す
  * コミットログもレビュー対象

## シチュエーション別 git の使い方

### 細かいコミットがいっぱいなので、いくつかくっつけて一個にしたい

* `git rebase` を使い、くっつけたいコミットに対して `squash` を指定する。

### コミットログを間違えたので修正したい

* 直前のコミットを修正するのであれば、`git commit --amend` を使う。
* もっと前のコミットを修正するのであれば、`git rebase -i HEAD~~~` を使う。

### 直前のコミットに入れ忘れた変更があった…

* 入れ忘れた変更を `git add` した後、`git commit --amend` を使う。

### 2個以上前のコミットに入れ忘れた変更があった…

* 入れ忘れた変更をコミットした後、`git rebase -i "変更を混ぜ込みたいコミットのハッシュ~"` をする。
* 入れ忘れたコミットに対して squash を指定し、変更を混ぜ込みたいコミットとくっつける。

### 俺のブランチより master が先に進んでしまってマージできない

* まず、master の最新をローカルリポジトリに反映するために master ブランチへチェックアウトし、 `git pull origin master` をする。
* その後、作業中のブランチに戻って `git rebase master` すると、master に入った変更が作業中のブランチに反映される。
* リモートに push するときは、`-f` を指定する。こんな感じ → `git push -f origin 作業中のブランチ名`

### プルリクがマージされるまで作業が進められない気がする

* そんなことはない。とはいえ円滑に作業を進めるためにはちょっと工夫する。
* A のブランチで作業 → プルリク提出
* プルリクを待っている間の作業は、A をベースにして B のブランチを作成して作業。
* A のプルリクに修正が入った場合、B のブランチに A の変更を反映させる必要がある。
  * B のブランチにて、`git rebase A` をやれば OK。

### コミットログは適当でいい？

* 赤塚は、適当ではダメだと思う派。
  * ログはあとから変更の理由を探るのに役立つ。
  * レビュー時においても変更の意図を把握するのに役立つ。
  * 関連 issue の番号と、変更の意図を書く。what や how ではなく、why が大事。

* あまり情報がないパターンのコミットログ
  * fix bug
  * reflect review pointing

## github の使い方

### 慣れてきたらフォークして開発するのがオススメ

* みんなが参照するリポジトリに作業用ブランチを push するのはあまり行儀よくない。
  * 作業後に消し忘れたりしたら永劫無駄なブランチが残る可能性。
  * 残しておくべきブランチとそうでないブランチが入り交じる。
* 各自は自分のアカウントにフォークを行い、作業用ブランチは各自のリポジトリに push する。
  * 各位のところにフォークされたリポジトリは各位が自由に使ってよい。
  * 本流への反映は必ずプルリクで行う。

### レビュアーのアサイン

* レビュー待ちになってるのに気付けない問題。
  * github のレビュアー機能の微妙さ…。
* オススメの流れ
  * プルリク出した人はレビュアーアサイン
  * レビュアーはレビュー実施 (この時点で勝手にレビュアーアサインが外れる)
  * プルリク出した人は指摘事項を修正。**再レビューが必要なときは再度レビュアーをアサインする。**
  * レビュアーはレビュー実施する。
  * **この流れにしとくと、レビュアーもレビューアサインされているプルリクを検索できて良い。**

### マージされたらブランチは消す

* あとで復元できるので残しておく意味は薄い。どんどん消そう。

### コミットログもレビュー対象

* コミットログは上述のように使う気になれば有用に使える。
* 後々グレップでひっかけられるか、将来的に見たときに意味が分かるか (意図が思い出せるか) などを考える。


